[
  {
    "type": "bash",
    "disabled": false,
    "code": "../bin/pip install pytorch-lightning==1.9.5"
  },
  {
    "type": "bash",
    "disabled": false,
    "code": "git clone https://github.com/BlinkDL/RWKV-LM\ncd RWKV-LM/RWKV-v5\nmkdir -p data"
  },
  {
    "type": "bash",
    "disabled": false,
    "code": "wget -nc https://developer.download.nvidia.com/compute/cuda/repos/wsl-ubuntu/x86_64/cuda-keyring_1.1-1_all.deb\nsudo dpkg -i cuda-keyring_1.1-1_all.deb\nsudo apt-get update\nsudo apt-get -y install cuda-toolkit-12-6\nsudo apt-get -y install nvidia-cuda-toolkit\nsudo apt-get -y install ninja-build\nwget -nc --continue -O data/minipile.idx https://huggingface.co/datasets/BlinkDL/minipile-tokenized/resolve/main/rwkv_vocab_v20230424/minipile.idx\nwget -nc --continue -O data/minipile.bin https://huggingface.co/datasets/BlinkDL/minipile-tokenized/resolve/main/rwkv_vocab_v20230424/minipile.bin\n../../../bin/pip install torch --upgrade --extra-index-url https://download.pytorch.org/whl/cu121\n../../../bin/pip install deepspeed wandb ninja --upgrade"
  },
  {
    "type": "bash",
    "disabled": false,
    "code": "# Prepare training\n../../../bin/python train.py --proj_dir \"out/L12-D768-x060\" --data_file \"data/minipile\" --data_type \"binidx\" --vocab_size 65536 --my_testing x060 --ctx_len 512 --my_pile_stage 1 --epoch_count 1 --epoch_begin 0 --epoch_save 1 --weight_decay 0 --head_size_a 64 --num_nodes 1 --micro_bsz 1 --n_layer 12 --n_embd 768 --pre_ffn 0 --head_qk 0 --my_exit_tokens 1498226207 --magic_prime 2926181 --lr_init 1e-5 --lr_final 1e-5 --warmup_steps 10 --beta1 0.9 --beta2 0.99 --adam_eps 1e-8 --my_pile_edecay 0 --accelerator cpu --devices 1 --precision bf16 --strategy deepspeed_stage_2 --grad_cp 1\n\n# Run training\n../../../bin/python train.py --load_model \"0\" --proj_dir \"out/L12-D768-x060\" --my_testing x060 --ctx_len 512 --my_pile_stage 3 --epoch_count 999999 --epoch_begin 0 --data_file \"data/minipile\" --my_exit_tokens 1498226207 --magic_prime 2926181 --num_nodes 1 --micro_bsz 16 --n_layer 12 --n_embd 768 --pre_ffn 0 --head_qk 0 --lr_init 6e-4 --lr_final 6e-5 --warmup_steps 10 --beta1 0.9 --beta2 0.99 --adam_eps 1e-8 --my_pile_edecay 0 --data_type \"binidx\" --vocab_size 65536 --weight_decay 0.001 --epoch_save 10 --head_size_a 64 --accelerator gpu --devices 1 --precision bf16 --strategy deepspeed_stage_2 --grad_cp 1 --enable_progress_bar True --ds_bucket_mb 2"
  }
]