# This file was automatically @generated by flatpack.ai on 2023-05-25 15:41:56.
# It is not intended for manual editing.

FROM debian:stable-slim

# Create directories
RUN mkdir -p /home/content/checkpoints /home/content/data /home/content/models /home/content/scripts
ENV model_name=nanogpt-shakespeare

# Install packages
RUN apt-get update && apt-get upgrade -y && apt-get install -y gcc git python3-pip wget && apt-get autoremove -y && apt-get clean && rm -rf /var/lib/apt/lists/* && pip install datasets numpy tiktoken torch tqdm transformers wandb

# Expose ports
EXPOSE 80

# Download datasets and files
RUN wget https://raw.githubusercontent.com/karpathy/char-rnn/master/data/tinyshakespeare/input.txt -O /home/content/data/input.txt
RUN wget https://raw.githubusercontent.com/romlingroup/flatpack-ai/main/warehouse/nanogpt-shakespeare/train.sh -O /home/content/train.sh

# Clone git repositories
RUN git clone https://github.com/karpathy/nanoGPT /home/content/nanoGPT

# RUN commands
RUN python3 /home/content/nanoGPT/data/shakespeare_char/prepare.py
RUN chmod +x /home/content/train.sh

# CMD command
CMD ["bash", "/home/content/train.sh"]

# Build complete! ðŸŽ‰
